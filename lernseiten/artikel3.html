<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artikel: Schweiz im internationalen Vergleich - hep Verlag</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #003876 0%, #5eb9b4 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: #003876;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .article-link {
            background: #f8f9fa;
            border-left: 4px solid #5eb9b4;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 5px;
        }

        .article-link h2 {
            color: #003876;
            margin-bottom: 10px;
        }

        /* === ZUSAMMENFASSUNG (AUSKLAPPBAR) === */
        .summary-section {
            margin: 30px 0;
            border: 3px solid #5eb9b4;
            border-radius: 10px;
            overflow: hidden;
        }

        .summary-header {
            background: linear-gradient(135deg, #003876, #5eb9b4);
            color: white;
            padding: 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            user-select: none;
        }

        .summary-header:hover {
            background: linear-gradient(135deg, #002855, #4a9a95);
        }

        .summary-header h2 {
            font-size: 1.5em;
            margin: 0;
        }

        .summary-toggle {
            font-size: 2em;
            transition: transform 0.3s;
        }

        .summary-section.open .summary-toggle {
            transform: rotate(180deg);
        }

        .summary-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            background: #f8f9fa;
        }

        .summary-section.open .summary-content {
            max-height: 2000px;
        }

        .summary-inner {
            padding: 30px;
        }

        /* === ACCORDION SYSTEM F√úR ALLE SEKTIONEN === */
        .accordion-section {
            margin: 40px 0;
            border: 3px solid #5eb9b4;
            border-radius: 10px;
            overflow: hidden;
            background: white;
        }

        .accordion-header {
            background: linear-gradient(135deg, #003876, #5eb9b4);
            color: white;
            padding: 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            user-select: none;
        }

        .accordion-header:hover {
            background: linear-gradient(135deg, #002855, #4a9a95);
        }

        .accordion-header h2 {
            font-size: 1.8em;
            margin: 0;
        }

        .accordion-toggle {
            font-size: 2em;
            transition: transform 0.3s;
            font-weight: bold;
        }

        .accordion-section.open .accordion-toggle {
            transform: rotate(180deg);
        }

        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            background: #f8f9fa;
        }

        .accordion-section.open .accordion-content {
            max-height: 3500px;
        }

        .accordion-inner {
            padding: 30px;
        }

        .key-points {
            display: grid;
            gap: 20px;
        }

        .key-point {
            background: white;
            padding: 20px;
            border-left: 5px solid #5eb9b4;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .key-point h3 {
            color: #003876;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .key-point p {
            line-height: 1.6;
            color: #333;
        }

        .key-stat {
            background: #5eb9b4;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
            font-weight: 600;
        }

        /* === INTERAKTIVE SEKTIONEN === */
        .section-intro {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.1em;
            color: #555;
        }

        /* === 1. ZEITSTRAHL-VISUALISIERUNG === */
        .timeline-visual {
            position: relative;
            padding: 40px 0;
            margin: 30px 0;
        }

        .timeline-line {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #003876, #5eb9b4);
        }

        .timeline-items {
            position: relative;
        }

        .timeline-item {
            display: flex;
            margin-bottom: 40px;
            position: relative;
            opacity: 0;
            animation: fadeInUp 0.6s ease-out forwards;
        }

        .timeline-item:nth-child(1) { animation-delay: 0.1s; }
        .timeline-item:nth-child(2) { animation-delay: 0.2s; }
        .timeline-item:nth-child(3) { animation-delay: 0.3s; }
        .timeline-item:nth-child(4) { animation-delay: 0.4s; }
        .timeline-item:nth-child(5) { animation-delay: 0.5s; }
        .timeline-item:nth-child(6) { animation-delay: 0.6s; }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .timeline-item.left {
            justify-content: flex-end;
            padding-right: calc(50% + 30px);
        }

        .timeline-item.right {
            justify-content: flex-start;
            padding-left: calc(50% + 30px);
        }

        .timeline-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            max-width: 400px;
            position: relative;
            border: 2px solid #5eb9b4;
        }

        .timeline-year {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            background: #003876;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2em;
            z-index: 10;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .timeline-item.left .timeline-year {
            left: auto;
            right: calc(50% - 60px);
            transform: none;
        }

        .timeline-item.right .timeline-year {
            left: calc(50% - 60px);
            transform: none;
        }

        .timeline-card h4 {
            color: #003876;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .timeline-card p {
            color: #555;
            line-height: 1.6;
        }

        /* === 2. L√ÑNDER-MATCHING-GAME === */
        .matching-game {
            margin-top: 30px;
        }

        .matching-pairs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 30px;
        }

        .matching-column h3 {
            color: #003876;
            margin-bottom: 20px;
            text-align: center;
        }

        .matching-items {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .match-card {
            background: white;
            padding: 20px;
            border: 3px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 1.1em;
            font-weight: 600;
            color: #003876;
        }

        .match-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border-color: #5eb9b4;
        }

        .match-card.selected {
            background: #5eb9b4;
            color: white;
            border-color: #5eb9b4;
        }

        .match-card.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
            animation: pulse 0.5s;
        }

        .match-card.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
            animation: shake 0.5s;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .matching-feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.2em;
            display: none;
        }

        .matching-feedback.show {
            display: block;
        }

        .matching-feedback.success {
            background: #e8f5e9;
            color: #2e7d32;
            border: 2px solid #4caf50;
        }

        /* === 3. STATISTIK-KARTEN === */
        .stat-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 5px solid #5eb9b4;
            transition: all 0.3s;
            cursor: pointer;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .stat-number {
            font-size: 3em;
            font-weight: bold;
            color: #003876;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1.1em;
            color: #555;
            margin-bottom: 15px;
        }

        .stat-detail {
            font-size: 0.9em;
            color: #777;
            line-height: 1.6;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .stat-card.expanded .stat-detail {
            max-height: 200px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #e0e0e0;
        }

        /* === 4. MYTHOS VS REALIT√ÑT === */
        .myth-reality {
            margin-top: 30px;
        }

        .myth-cards {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .myth-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .myth-statement {
            padding: 25px;
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            font-size: 1.15em;
            font-weight: 600;
            color: #856404;
        }

        .myth-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
        }

        .myth-btn {
            padding: 20px;
            border: none;
            background: white;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s;
            border-top: 2px solid #e0e0e0;
        }

        .myth-btn:first-child {
            border-right: 1px solid #e0e0e0;
        }

        .myth-btn:hover {
            background: #f8f9fa;
        }

        .myth-btn.correct {
            background: #4caf50;
            color: white;
        }

        .myth-btn.incorrect {
            background: #f44336;
            color: white;
        }

        .myth-explanation {
            padding: 20px;
            background: #f8f9fa;
            border-top: 2px solid #e0e0e0;
            display: none;
            line-height: 1.6;
        }

        .myth-explanation.show {
            display: block;
        }

        .myth-explanation.correct {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .myth-explanation.incorrect {
            background: #ffebee;
            color: #c62828;
        }

        /* === QUIZ (GESPERRT BIS ALLE AKTIVIT√ÑTEN ABGESCHLOSSEN) === */
        .quiz-section {
            margin-top: 50px;
            padding-top: 30px;
            border-top: 3px solid #5eb9b4;
            position: relative;
        }

        .quiz-section.locked {
            opacity: 0.5;
            pointer-events: none;
        }

        .quiz-lock-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 56, 118, 0.95);
            color: white;
            padding: 30px 40px;
            border-radius: 10px;
            text-align: center;
            z-index: 10;
            display: none;
        }

        .quiz-section.locked .quiz-lock-overlay {
            display: block;
        }

        .quiz-section h2 {
            color: #003876;
            margin-bottom: 30px;
            font-size: 1.8em;
            text-align: center;
        }

        .question {
            background: #f8f9fa;
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .question.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .question.answered {
            border-color: #5eb9b4;
        }

        .question h3 {
            color: #003876;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            background: white;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: #5eb9b4;
            transform: translateX(5px);
        }

        .option.selected {
            background: #5eb9b4;
            color: white;
            border-color: #5eb9b4;
        }

        .option.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .option.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #e8f5e9;
            color: #2e7d32;
            border-left: 4px solid #4caf50;
        }

        .feedback.incorrect {
            background: #ffebee;
            color: #c62828;
            border-left: 4px solid #f44336;
        }

        .next-button {
            background: #003876;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            font-size: 1em;
            transition: background 0.3s;
            display: none;
        }

        .next-button.show {
            display: inline-block;
        }

        .next-button:hover {
            background: #002855;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            margin: 30px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #003876, #5eb9b4);
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-text {
            text-align: center;
            color: #003876;
            margin-bottom: 10px;
            font-weight: bold;
        }

        /* === COMPLETION === */
        .completion-message {
            background: linear-gradient(135deg, #4caf50, #8bc34a);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin-top: 30px;
            display: none;
        }

        .completion-message.show {
            display: block;
        }

        .completion-message h3 {
            font-size: 2em;
            margin-bottom: 15px;
        }

        /* === NAVIGATION === */
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        .nav-button {
            background: #5eb9b4;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            text-decoration: none;
            display: inline-block;
            transition: background 0.3s;
        }

        .nav-button:hover {
            background: #4a9a95;
        }

        .nav-button.secondary {
            background: #003876;
        }

        .nav-button.secondary:hover {
            background: #002855;
        }

        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }

            .timeline-item.left,
            .timeline-item.right {
                padding: 0;
                justify-content: center;
            }

            .timeline-year {
                position: static;
                transform: none;
                margin-bottom: 15px;
            }

            .matching-pairs {
                grid-template-columns: 1fr;
                gap: 30px;
            }

            .stat-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç Artikel: Internationaler Vergleich</h1>
            <p>Mit Erbschaftssteuern f√ºr Superreiche w√ºrde die Schweiz zum Super-Sonderfall</p>
        </div>

        <div class="content">
            <div class="article-link">
                <h2>üìÑ Originalartikel</h2>
                <p><strong>Autor:</strong> Simon Schmid</p>
                <p><strong>Thema:</strong> Juso-Initiative im L√§ndervergleich ‚Äì Historische Entwicklung der Erbschaftssteuern weltweit</p>
                <a href="https://www.tagesanzeiger.ch/erbschaftssteuer-schweiz-juso-initiative-als-globaler-sonderfall-142294996360" style="display: inline-block; background: #5eb9b4; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; margin-top: 10px;" target="_blank">Artikel im Original lesen (freiwillig) ‚Üí</a>
            </div>

            <!-- === ZUSAMMENFASSUNG (AUSKLAPPBAR) === -->
            <div class="summary-section" id="summary-section">
                <div class="summary-header" onclick="toggleSummary()">
                    <h2>üìã Artikel-Zusammenfassung</h2>
                    <span class="summary-toggle">‚ñº</span>
                </div>
                <div class="summary-content">
                    <div class="summary-inner">
                        <div class="key-points">
                            <div class="key-point">
                                <h3>üèõÔ∏è Historische Entwicklung</h3>
                                <p>Erbschaftssteuern sind die √§ltesten modernen Steuerformen. Sie wurden oft zur Kriegsfinanzierung eingef√ºhrt ‚Äì etwa in √ñsterreich 1759 (Siebenj√§hriger Krieg) oder Grossbritannien 1796 (Krieg gegen Napoleon).</p>
                                <span class="key-stat">Im 20. Jahrhundert: Steuers√§tze 40-80%</span>
                            </div>

                            <div class="key-point">
                                <h3>üìâ Der grosse R√ºckgang</h3>
                                <p>Ab 1970 setzte eine Gegenbewegung ein: Viele L√§nder schafften die Erbschaftssteuer ab oder senkten die S√§tze massiv. Kanada (1971), Australien (1979), Neuseeland (2001), Schweden (2004), √ñsterreich (2008), Norwegen (2013).</p>
                                <span class="key-stat">Heute: < 0,5% der OECD-Steuereinnahmen</span>
                            </div>

                            <div class="key-point">
                                <h3>üá®üá≠ Schweizer Sonderfall</h3>
                                <p>Die Schweiz ist fast weltweit einzigartig: Sie hat SOWOHL eine Verm√∂genssteuer ALS AUCH eine Erbschaftssteuer. Zudem ist die Regelung f√∂deral ‚Äì jeder Kanton entscheidet selbst. In den meisten Kantonen zahlen direkte Nachkommen keine Erbschaftssteuer.</p>
                                <span class="key-stat">Doppelbesteuerung: Verm√∂gen + Erbe</span>
                            </div>

                            <div class="key-point">
                                <h3>üéØ Juso-Initiative</h3>
                                <p>Die Initiative fordert 50% Steuersatz ab 50 Millionen Franken ‚Äì eine weltweit einzigartige Kombination. Laura Seelkopf (√ñkonomin): ¬´sehr ungew√∂hnlich¬ª und w√ºrde die Schweiz zum ¬´Super-Sonderfall¬ª machen.</p>
                                <span class="key-stat">50% ab 50 Mio. CHF</span>
                            </div>

                            <div class="key-point">
                                <h3>üí° Warum der R√ºckgang?</h3>
                                <p>Gr√ºnde f√ºr die Abschaffung: (1) Fehlende Dringlichkeit in Friedenszeiten, (2) Praktische Probleme f√ºr Familienbetriebe, (3) Unfaire Lastverteilung (Mittelklasse zahlt mehr als Reiche durch Ausnahmen), (4) Globalisierung und Kapitalmobilit√§t.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- === 1. ZEITSTRAHL === -->
            <div class="accordion-section" id="timeline-accordion">
                <div class="accordion-header" onclick="toggleAccordion('timeline-accordion')">
                    <h2>üìÖ Interaktiv 1: Abschaffungs-Zeitstrahl</h2>
                    <span class="accordion-toggle">‚ñº</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-inner">
                        <p class="section-intro">Sehen Sie, wie L√§nder √ºber 42 Jahre hinweg die Erbschaftssteuer abschafften</p>

                        <div class="timeline-visual">
                            <div class="timeline-line"></div>
                            <div class="timeline-items">
                                <div class="timeline-item left">
                                    <div class="timeline-year">1971</div>
                                    <div class="timeline-card">
                                        <h4>üá®üá¶ Kanada</h4>
                                        <p>Als eines der ersten Industriel√§nder schafft Kanada die Erbschaftssteuer ab und f√ºhrt stattdessen eine Kapitalgewinnsteuer ein.</p>
                                    </div>
                                </div>

                                <div class="timeline-item right">
                                    <div class="timeline-year">1979</div>
                                    <div class="timeline-card">
                                        <h4>üá¶üá∫ Australien</h4>
                                        <p>Australien folgt dem kanadischen Beispiel und schafft die Erbschaftssteuer vollst√§ndig ab.</p>
                                    </div>
                                </div>

                                <div class="timeline-item left">
                                    <div class="timeline-year">2001</div>
                                    <div class="timeline-card">
                                        <h4>üá≥üáø Neuseeland</h4>
                                        <p>Nach jahrzehntelanger Debatte streicht Neuseeland die Erbschaftssteuer komplett.</p>
                                    </div>
                                </div>

                                <div class="timeline-item right">
                                    <div class="timeline-year">2004</div>
                                    <div class="timeline-card">
                                        <h4>üá∏üá™ Schweden</h4>
                                        <p>Trotz sozialdemokratischer Regierung: Abschaffung, weil Ausnahmen die Mittelklasse unfair belasteten.</p>
                                    </div>
                                </div>

                                <div class="timeline-item left">
                                    <div class="timeline-year">2008</div>
                                    <div class="timeline-card">
                                        <h4>üá¶üáπ √ñsterreich</h4>
                                        <p>Das Land, das 1759 eine der ersten Erbschaftssteuern einf√ºhrte, schafft sie nach 249 Jahren ab.</p>
                                    </div>
                                </div>

                                <div class="timeline-item right">
                                    <div class="timeline-year">2013</div>
                                    <div class="timeline-card">
                                        <h4>üá≥üá¥ Norwegen</h4>
                                        <p>Selbst der Wohlfahrtsstaat Norwegen streicht die Erbschaftssteuer wegen Kapitalmobilit√§t.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- === 2. MATCHING GAME === -->
            <div class="accordion-section" id="matching-accordion">
                <div class="accordion-header" onclick="toggleAccordion('matching-accordion')">
                    <h2>üéØ Interaktiv 2: L√§nder-Eigenschaften zuordnen</h2>
                    <span class="accordion-toggle">‚ñº</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-inner">
                        <p class="section-intro">W√§hlen Sie ein Land links und dann die passende Eigenschaft rechts</p>

                        <div class="matching-game">
                            <div class="matching-pairs">
                                <div class="matching-column">
                                    <h3>L√§nder</h3>
                                    <div class="matching-items" id="matching-countries">
                                        <div class="match-card" data-match="schweden">üá∏üá™ Schweden</div>
                                        <div class="match-card" data-match="schweiz">üá®üá≠ Schweiz</div>
                                        <div class="match-card" data-match="oesterreich">üá¶üáπ √ñsterreich</div>
                                        <div class="match-card" data-match="usa">üá∫üá∏ USA</div>
                                    </div>
                                </div>

                                <div class="matching-column">
                                    <h3>Eigenschaften</h3>
                                    <div class="matching-items" id="matching-properties">
                                        <div class="match-card" data-match="schweiz">Verm√∂gens- UND Erbschaftssteuer</div>
                                        <div class="match-card" data-match="oesterreich">Erste Erbschaftssteuer 1759</div>
                                        <div class="match-card" data-match="schweden">Abschaffung unter Sozialdemokraten</div>
                                        <div class="match-card" data-match="usa">Viele Schlupfl√∂cher f√ºr Milliard√§re</div>
                                    </div>
                                </div>
                            </div>

                            <div class="matching-feedback" id="matching-feedback"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- === 3. STATISTIK-KARTEN === -->
            <div class="accordion-section" id="stats-accordion">
                <div class="accordion-header" onclick="toggleAccordion('stats-accordion')">
                    <h2>üìä Interaktiv 3: Zahlen & Fakten</h2>
                    <span class="accordion-toggle">‚ñº</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-inner">
                        <p class="section-intro">Klicken Sie auf eine Karte f√ºr mehr Details</p>

                        <div class="stat-cards">
                            <div class="stat-card" onclick="toggleStatCard(this)">
                                <div class="stat-number">< 0.5%</div>
                                <div class="stat-label">der OECD-Steuereinnahmen</div>
                                <div class="stat-detail">Erbschaftssteuern tragen heute weniger als 0,5% zu den gesamten Steuereinnahmen der OECD-L√§nder bei ‚Äì ein drastischer R√ºckgang seit den 1970er Jahren.</div>
                            </div>

                            <div class="stat-card" onclick="toggleStatCard(this)">
                                <div class="stat-number">50%</div>
                                <div class="stat-label">der L√§nder weltweit</div>
                                <div class="stat-detail">Etwa die H√§lfte aller L√§nder weltweit kennen heute noch eine Form der Erbschaftssteuer. Die andere H√§lfte hat sie abgeschafft.</div>
                            </div>

                            <div class="stat-card" onclick="toggleStatCard(this)">
                                <div class="stat-number">40-80%</div>
                                <div class="stat-label">Spitzensteuers√§tze fr√ºher</div>
                                <div class="stat-detail">Im 20. Jahrhundert lagen die Spitzensteuers√§tze f√ºr Erbschaften in L√§ndern wie Frankreich, Deutschland, Japan und den USA zwischen 40 und 80 Prozent.</div>
                            </div>

                            <div class="stat-card" onclick="toggleStatCard(this)">
                                <div class="stat-number">249</div>
                                <div class="stat-label">Jahre in √ñsterreich</div>
                                <div class="stat-detail">√ñsterreich f√ºhrte 1759 eine der ersten Erbschaftssteuern ein und schaffte sie 2008 wieder ab ‚Äì nach 249 Jahren.</div>
                            </div>

                            <div class="stat-card" onclick="toggleStatCard(this)">
                                <div class="stat-number">50 Mio.</div>
                                <div class="stat-label">CHF Freibetrag</div>
                                <div class="stat-detail">Die Juso-Initiative sieht einen Freibetrag von 50 Millionen Franken vor ‚Äì deutlich h√∂her als in den meisten anderen L√§ndern mit Erbschaftssteuern.</div>
                            </div>

                            <div class="stat-card" onclick="toggleStatCard(this)">
                                <div class="stat-number">2</div>
                                <div class="stat-label">Steuern gleichzeitig</div>
                                <div class="stat-detail">Die Schweiz ist fast weltweit einzigartig: Sie erhebt sowohl eine Verm√∂genssteuer zu Lebzeiten als auch eine Erbschaftssteuer nach dem Tod.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- === 4. MYTHOS VS REALIT√ÑT === -->
            <div class="accordion-section" id="myths-accordion">
                <div class="accordion-header" onclick="toggleAccordion('myths-accordion')">
                    <h2>üí° Interaktiv 4: Mythos oder Realit√§t?</h2>
                    <span class="accordion-toggle">‚ñº</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-inner">
                        <p class="section-intro">Testen Sie Ihr Wissen ‚Äì was stimmt wirklich?</p>

                        <div class="myth-reality">
                            <div class="myth-cards">
                                <!-- Mythos 1 -->
                                <div class="myth-card">
                                    <div class="myth-statement">
                                        Erbschaftssteuern wurden historisch oft zur Kriegsfinanzierung eingef√ºhrt
                                    </div>
                                    <div class="myth-buttons">
                                        <button class="myth-btn" onclick="checkMyth(this, 'reality', 1)">‚úì Realit√§t</button>
                                        <button class="myth-btn" onclick="checkMyth(this, 'myth', 1)">‚úó Mythos</button>
                                    </div>
                                    <div class="myth-explanation" id="myth-explanation-1">
                                        √ñsterreich f√ºhrte 1759 eine Erbschaftssteuer zur Finanzierung des Siebenj√§hrigen Krieges ein, Grossbritannien 1796 f√ºr den Krieg gegen Napoleon.
                                    </div>
                                </div>

                                <!-- Mythos 2 -->
                                <div class="myth-card">
                                    <div class="myth-statement">
                                        Die Schweiz ist das einzige Land mit Erbschaftssteuern
                                    </div>
                                    <div class="myth-buttons">
                                        <button class="myth-btn" onclick="checkMyth(this, 'reality', 2)">‚úì Realit√§t</button>
                                        <button class="myth-btn" onclick="checkMyth(this, 'myth', 2)">‚úó Mythos</button>
                                    </div>
                                    <div class="myth-explanation" id="myth-explanation-2">
                                        Mythos! Etwa 50% der L√§nder weltweit kennen heute noch eine Form der Erbschaftssteuer. Beispiele: Frankreich, Deutschland, USA, Japan, Grossbritannien.
                                    </div>
                                </div>

                                <!-- Mythos 3 -->
                                <div class="myth-card">
                                    <div class="myth-statement">
                                        In Schweden schaffte eine sozialdemokratische Regierung die Erbschaftssteuer ab
                                    </div>
                                    <div class="myth-buttons">
                                        <button class="myth-btn" onclick="checkMyth(this, 'reality', 3)">‚úì Realit√§t</button>
                                        <button class="myth-btn" onclick="checkMyth(this, 'myth', 3)">‚úó Mythos</button>
                                    </div>
                                    <div class="myth-explanation" id="myth-explanation-3">
                                        Realit√§t! 2004 schaffte ausgerechnet eine sozialdemokratische Regierung die Steuer ab, weil Ausnahmen dazu f√ºhrten, dass die Mittelklasse unfair belastet wurde.
                                    </div>
                                </div>

                                <!-- Mythos 4 -->
                                <div class="myth-card">
                                    <div class="myth-statement">
                                        Die Juso-Initiative mit 50% ab 50 Mio. CHF ist international √ºblich
                                    </div>
                                    <div class="myth-buttons">
                                        <button class="myth-btn" onclick="checkMyth(this, 'reality', 4)">‚úì Realit√§t</button>
                                        <button class="myth-btn" onclick="checkMyth(this, 'myth', 4)">‚úó Mythos</button>
                                    </div>
                                    <div class="myth-explanation" id="myth-explanation-4">
                                        Mythos! Laura Seelkopf bezeichnet die Kombination als ¬´sehr ungew√∂hnlich¬ª und weltweit einzigartig. Nirgendwo sonst gibt es so hohe Steuers√§tze bei so hohen Freibetr√§gen.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- === QUIZ === -->
            <div class="quiz-section locked" id="quiz-section">
                <div class="quiz-lock-overlay">
                    <h3>üîí Quiz gesperrt</h3>
                    <p>Bitte schlie√üen Sie erst alle vier interaktiven Lernmodule ab, um das Quiz freizuschalten.</p>
                    <p style="margin-top: 15px; font-size: 0.9em;">‚úÖ Zeitstrahl | ‚úÖ Matching | ‚úÖ Statistiken | ‚úÖ Mythen</p>
                </div>

                <h2>üìù Abschluss-Quiz: Kontrollfragen</h2>
                <div class="progress-text">Fortschritt: <span id="quiz-progress">0/6</span> Fragen beantwortet</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>

                <!-- Frage 1 -->
                <div class="question active" data-question="1">
                    <h3>Frage 1 von 6: Wof√ºr wurden Erbschaftssteuern historisch oft eingef√ºhrt?</h3>
                    <div class="options">
                        <div class="option" data-answer="wrong">Zur Finanzierung von Infrastrukturprojekten</div>
                        <div class="option" data-answer="correct">Zur Kriegsfinanzierung</div>
                        <div class="option" data-answer="wrong">Zur Umverteilung von Verm√∂gen</div>
                        <div class="option" data-answer="wrong">Zur Finanzierung des Bildungssystems</div>
                    </div>
                    <div class="feedback"></div>
                    <button class="next-button" onclick="showNextQuestion()">N√§chste Frage ‚Üí</button>
                </div>

                <!-- Frage 2 -->
                <div class="question" data-question="2">
                    <h3>Frage 2 von 6: Was macht die Schweiz im internationalen Vergleich besonders?</h3>
                    <div class="options">
                        <div class="option" data-answer="wrong">Sie hat die h√∂chsten Erbschaftssteuern weltweit</div>
                        <div class="option" data-answer="correct">Sie hat sowohl Verm√∂genssteuer als auch Erbschaftssteuer ‚Äì fast einzigartig</div>
                        <div class="option" data-answer="wrong">Sie hat die Erbschaftssteuer 2013 abgeschafft</div>
                        <div class="option" data-answer="wrong">Sie besteuert nur Nicht-Verwandte, nicht aber direkte Nachkommen</div>
                    </div>
                    <div class="feedback"></div>
                    <button class="next-button" onclick="showNextQuestion()">N√§chste Frage ‚Üí</button>
                </div>

                <!-- Frage 3 -->
                <div class="question" data-question="3">
                    <h3>Frage 3 von 6: Welches Land schaffte 2004 die Erbschaftssteuer ab, obwohl eine sozialdemokratische Regierung an der Macht war?</h3>
                    <div class="options">
                        <div class="option" data-answer="wrong">Norwegen</div>
                        <div class="option" data-answer="correct">Schweden</div>
                        <div class="option" data-answer="wrong">√ñsterreich</div>
                        <div class="option" data-answer="wrong">Australien</div>
                    </div>
                    <div class="feedback"></div>
                    <button class="next-button" onclick="showNextQuestion()">N√§chste Frage ‚Üí</button>
                </div>

                <!-- Frage 4 -->
                <div class="question" data-question="4">
                    <h3>Frage 4 von 6: Wie viel Prozent der gesamten Steuereinnahmen in OECD-L√§ndern stammen heute aus Erbschaftssteuern?</h3>
                    <div class="options">
                        <div class="option" data-answer="wrong">Etwa 5 Prozent</div>
                        <div class="option" data-answer="wrong">Etwa 2 Prozent</div>
                        <div class="option" data-answer="correct">Weniger als 0,5 Prozent</div>
                        <div class="option" data-answer="wrong">Etwa 10 Prozent</div>
                    </div>
                    <div class="feedback"></div>
                    <button class="next-button" onclick="showNextQuestion()">N√§chste Frage ‚Üí</button>
                </div>

                <!-- Frage 5 -->
                <div class="question" data-question="5">
                    <h3>Frage 5 von 6: Warum bezeichnet Laura Seelkopf die Juso-Initiative als ¬´sehr ungew√∂hnlich¬ª?</h3>
                    <div class="options">
                        <div class="option" data-answer="wrong">Weil sie zu niedrige Steuers√§tze vorsieht</div>
                        <div class="option" data-answer="correct">Weil die Kombination von 50% Steuersatz und 50 Mio. Freibetrag weltweit einzigartig ist</div>
                        <div class="option" data-answer="wrong">Weil sie auch kleine Erbschaften besteuert</div>
                        <div class="option" data-answer="wrong">Weil sie nur f√ºr ausl√§ndische Erben gilt</div>
                    </div>
                    <div class="feedback"></div>
                    <button class="next-button" onclick="showNextQuestion()">N√§chste Frage ‚Üí</button>
                </div>

                <!-- Frage 6 -->
                <div class="question" data-question="6">
                    <h3>Frage 6 von 6: Welcher Grund wird im Artikel NICHT als Erkl√§rung f√ºr den R√ºckgang der Erbschaftssteuern genannt?</h3>
                    <div class="options">
                        <div class="option" data-answer="wrong">Fehlende Dringlichkeit in Friedenszeiten</div>
                        <div class="option" data-answer="wrong">Praktische Probleme f√ºr Erben von Familienbetrieben</div>
                        <div class="option" data-answer="correct">Steigende Lebenserwartung der Bev√∂lkerung</div>
                        <div class="option" data-answer="wrong">Zunehmende Kapitalmobilit√§t durch Globalisierung</div>
                    </div>
                    <div class="feedback"></div>
                    <button class="next-button" onclick="showNextQuestion()">Quiz abschlie√üen ‚úì</button>
                </div>
            </div>

            <div class="completion-message" id="completion-message">
                <h3>üéâ Herzlichen Gl√ºckwunsch!</h3>
                <p>Sie haben alle Lernmodule und das Quiz abgeschlossen!</p>
                <p style="margin-top: 15px;">Ihr Fortschritt wurde gespeichert.</p>
            </div>

            <div class="navigation">
                <a href="../dashboard.html" class="nav-button secondary">‚Üê Zum Dashboard</a>
                <a href="artikel4.html" class="nav-button">N√§chster Artikel ‚Üí</a>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="../firebase-config.js"></script>

    <script>
// === FIREBASE TRACKING ===
let pageStartTime = Date.now();

function getUserCode() {
    return localStorage.getItem('userCode') || 'anonymous';
}

function trackPageVisit(pageName) {
    const userCode = getUserCode();
    firebase.database().ref('users/' + userCode + '/visits/' + pageName).set({
        timestamp: Date.now(),
        page: pageName
    });
}

function trackTimeSpent(pageName) {
    const userCode = getUserCode();
    const timeSpent = Math.floor((Date.now() - pageStartTime) / 1000);
    firebase.database().ref('users/' + userCode + '/timeSpent/' + pageName).set({
        seconds: timeSpent,
        timestamp: Date.now()
    });
}

function trackQuizCompletion(pageName, correctAnswers, totalQuestions) {
    const userCode = getUserCode();
    firebase.database().ref('users/' + userCode + '/quizzes/' + pageName).set({
        correctAnswers: correctAnswers,
        totalQuestions: totalQuestions,
        timestamp: Date.now()
    });
}

function markArticleComplete(pageName) {
    const userCode = getUserCode();
    firebase.database().ref('users/' + userCode + '/completions/' + pageName).set({
        completed: true,
        timestamp: Date.now()
    });
}

function trackActivityComplete(pageName, activityName) {
    const userCode = getUserCode();
    firebase.database().ref('users/' + userCode + '/activities/' + pageName + '/' + activityName).set({
        completed: true,
        timestamp: Date.now()
    });
}

// === LOCALSTORAGE FUNKTIONEN ===
function getStorageKey(key) {
    const userCode = getUserCode();
    return `artikel3_${userCode}_${key}`;
}

function saveProgress() {
    localStorage.setItem(getStorageKey('completedActivities'), JSON.stringify(completedActivities));
    localStorage.setItem(getStorageKey('clickedStatsCards'), JSON.stringify([...clickedStatsCards]));
    localStorage.setItem(getStorageKey('matchingCompleted'), matchingCompleted);
    localStorage.setItem(getStorageKey('answeredMyths'), JSON.stringify([...answeredMyths]));
    localStorage.setItem(getStorageKey('currentQuestion'), currentQuestion);
    localStorage.setItem(getStorageKey('answeredQuestions'), JSON.stringify([...answeredQuestions]));
    localStorage.setItem(getStorageKey('correctQuizAnswers'), correctQuizAnswers);
    localStorage.setItem(getStorageKey('quizUnlocked'), !document.getElementById('quiz-section').classList.contains('locked'));
    console.log('‚úì Progress saved to localStorage');
}

function loadProgress() {
    const savedActivities = localStorage.getItem(getStorageKey('completedActivities'));
    const savedStatsCards = localStorage.getItem(getStorageKey('clickedStatsCards'));
    const savedMatching = localStorage.getItem(getStorageKey('matchingCompleted'));
    const savedMyths = localStorage.getItem(getStorageKey('answeredMyths'));
    const savedCurrentQuestion = localStorage.getItem(getStorageKey('currentQuestion'));
    const savedAnsweredQuestions = localStorage.getItem(getStorageKey('answeredQuestions'));
    const savedCorrectAnswers = localStorage.getItem(getStorageKey('correctQuizAnswers'));
    
    let hasProgress = false;
    
    if (savedActivities) {
        Object.assign(completedActivities, JSON.parse(savedActivities));
        hasProgress = true;
    }
    
    if (savedStatsCards) {
        clickedStatsCards = new Set(JSON.parse(savedStatsCards));
        hasProgress = true;
    }
    
    if (savedMatching) {
        matchingCompleted = parseInt(savedMatching);
        hasProgress = true;
    }
    
    if (savedMyths) {
        answeredMyths = new Set(JSON.parse(savedMyths));
        hasProgress = true;
    }
    
    if (savedCurrentQuestion) {
        currentQuestion = parseInt(savedCurrentQuestion);
        hasProgress = true;
    }
    
    if (savedAnsweredQuestions) {
        answeredQuestions = new Set(JSON.parse(savedAnsweredQuestions));
        hasProgress = true;
    }
    
    if (savedCorrectAnswers) {
        correctQuizAnswers = parseInt(savedCorrectAnswers);
        hasProgress = true;
    }
    
    return hasProgress;
}

function restoreUIState() {
    // Restore accordion states
    restoreAccordionStates();
    
    // Restore stat cards
    clickedStatsCards.forEach(index => {
        const cards = document.querySelectorAll('.stat-card');
        if (cards[index]) {
            cards[index].classList.add('expanded');
        }
    });
    
    // Restore matching game
    const countryCards = document.querySelectorAll('#matching-countries .match-card');
    const propertyCards = document.querySelectorAll('#matching-properties .match-card');
    
    if (matchingCompleted === 4) {
        countryCards.forEach(card => {
            card.classList.add('correct');
            card.style.pointerEvents = 'none';
        });
        propertyCards.forEach(card => {
            card.classList.add('correct');
            card.style.pointerEvents = 'none';
        });
        
        const feedback = document.getElementById('matching-feedback');
        feedback.className = 'matching-feedback success show';
        feedback.textContent = 'üéâ Perfekt! Alle Zuordnungen sind korrekt!';
    }
    
    // Restore myths
    answeredMyths.forEach(mythNum => {
        const card = document.querySelectorAll('.myth-card')[mythNum - 1];
        if (card) {
            const buttons = card.querySelectorAll('.myth-btn');
            const explanation = card.querySelector('.myth-explanation');
            
            buttons.forEach(btn => btn.disabled = true);
            
            const correct = mythAnswers[mythNum];
            const correctBtn = Array.from(buttons).find(btn => 
                btn.textContent.includes(correct === 'reality' ? 'Realit√§t' : 'Mythos')
            );
            if (correctBtn) correctBtn.classList.add('correct');
            
            explanation.classList.add('show', 'correct');
        }
    });
    
    // Restore quiz
    if (answeredQuestions.size > 0) {
        document.querySelectorAll('.question').forEach((q, index) => {
            const qNum = (index + 1).toString();
            q.classList.toggle('active', index === currentQuestion - 1);
            
            if (answeredQuestions.has(qNum)) {
                q.classList.add('answered');
                const nextButton = q.querySelector('.next-button');
                if (nextButton) nextButton.classList.add('show');
            }
        });
        updateProgress();
    }
    
    // Unlock quiz if all activities complete
    if (completedActivities.timeline && completedActivities.matching && 
        completedActivities.stats && completedActivities.myths) {
        document.getElementById('quiz-section').classList.remove('locked');
    }
    
    console.log('‚úì UI state restored');
}

// === PROGRESS TRACKING ===
const completedActivities = {
    timeline: false,
    matching: false,
    stats: false,
    myths: false
};

function markActivityComplete(activityName) {
    if (completedActivities[activityName]) return;
    
    completedActivities[activityName] = true;
    trackActivityComplete('artikel3', activityName);
    saveProgress();
    
    console.log('‚úÖ Activity completed:', activityName);
    console.log('üìä Status:', completedActivities);
    
    checkAllActivitiesComplete();
}

function checkAllActivitiesComplete() {
    const allComplete = completedActivities.timeline && 
                       completedActivities.matching && 
                       completedActivities.stats && 
                       completedActivities.myths;
    
    if (allComplete) {
        console.log('üéâ All 4 activities completed - unlocking quiz!');
        unlockQuiz();
    }
}

function unlockQuiz() {
    const quizSection = document.getElementById('quiz-section');
    if (!quizSection.classList.contains('locked')) {
        return;
    }
    
    quizSection.classList.remove('locked');
    
    setTimeout(() => {
        const yOffset = -100;
        const y = quizSection.getBoundingClientRect().top + window.pageYOffset + yOffset;
        window.scrollTo({top: y, behavior: 'smooth'});
        console.log('üìú Scrolled to quiz section');
    }, 100);
    
    const message = document.createElement('div');
    message.style.cssText = 'position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #4caf50; color: white; padding: 20px 40px; border-radius: 10px; font-size: 1.2em; z-index: 1000; box-shadow: 0 4px 20px rgba(0,0,0,0.3);';
    message.textContent = 'üéâ Quiz freigeschaltet! Alle Module abgeschlossen.';
    document.body.appendChild(message);
    
    setTimeout(() => {
        message.style.transition = 'opacity 0.5s';
        message.style.opacity = '0';
        setTimeout(() => message.remove(), 500);
    }, 3000);
    
    saveProgress();
}

// === ZUSAMMENFASSUNG TOGGLE ===
function toggleSummary() {
    const section = document.getElementById('summary-section');
    section.classList.toggle('open');
}

// === ACCORDION TOGGLE ===
function toggleAccordion(sectionId) {
    const section = document.getElementById(sectionId);
    section.classList.toggle('open');
    saveAccordionState(sectionId, section.classList.contains('open'));
}

function saveAccordionState(sectionId, isOpen) {
    const key = getStorageKey('accordion_' + sectionId);
    localStorage.setItem(key, isOpen);
}

function restoreAccordionStates() {
    const accordions = [
        'timeline-accordion', 
        'matching-accordion', 
        'stats-accordion', 
        'myths-accordion'
    ];
    
    accordions.forEach(id => {
        const key = getStorageKey('accordion_' + id);
        const isOpen = localStorage.getItem(key) === 'true';
        if (isOpen) {
            document.getElementById(id).classList.add('open');
        }
    });
}

// === STATISTIK-KARTEN ===
function toggleStatCard(card) {
    card.classList.toggle('expanded');
}

let clickedStatsCards = new Set();
document.querySelectorAll('.stat-card').forEach((card, index) => {
    card.addEventListener('click', () => {
        clickedStatsCards.add(index);
        saveProgress();
        
        if (clickedStatsCards.size >= 3 && !completedActivities.stats) {
            setTimeout(() => {
                markActivityComplete('stats');
            }, 500);
        }
    });
});

// === MATCHING GAME ===
let selectedCountry = null;
let selectedProperty = null;
let matchingCompleted = 0;

const correctMatches = {
    'schweden': 'schweden',
    'schweiz': 'schweiz',
    'oesterreich': 'oesterreich',
    'usa': 'usa'
};

document.querySelectorAll('#matching-countries .match-card').forEach(card => {
    card.addEventListener('click', function() {
        if (this.classList.contains('correct')) return;
        
        document.querySelectorAll('#matching-countries .match-card').forEach(c => {
            c.classList.remove('selected');
        });
        this.classList.add('selected');
        selectedCountry = this.dataset.match;
        
        checkMatch();
    });
});

document.querySelectorAll('#matching-properties .match-card').forEach(card => {
    card.addEventListener('click', function() {
        if (this.classList.contains('correct')) return;
        
        document.querySelectorAll('#matching-properties .match-card').forEach(c => {
            c.classList.remove('selected');
        });
        this.classList.add('selected');
        selectedProperty = this.dataset.match;
        
        checkMatch();
    });
});

function checkMatch() {
    if (!selectedCountry || !selectedProperty) return;
    
    const countryCard = document.querySelector(`#matching-countries .match-card[data-match="${selectedCountry}"]`);
    const propertyCard = document.querySelector(`#matching-properties .match-card[data-match="${selectedProperty}"]`);
    
    if (selectedCountry === correctMatches[selectedProperty]) {
        countryCard.classList.remove('selected');
        countryCard.classList.add('correct');
        propertyCard.classList.remove('selected');
        propertyCard.classList.add('correct');
        
        matchingCompleted++;
        saveProgress();
        
        if (matchingCompleted === 4) {
            const feedback = document.getElementById('matching-feedback');
            feedback.className = 'matching-feedback success show';
            feedback.textContent = 'üéâ Perfekt! Alle Zuordnungen sind korrekt!';
            markActivityComplete('matching');
        }
    } else {
        countryCard.classList.add('incorrect');
        propertyCard.classList.add('incorrect');
        
        setTimeout(() => {
            countryCard.classList.remove('incorrect', 'selected');
            propertyCard.classList.remove('incorrect', 'selected');
        }, 1000);
    }
    
    selectedCountry = null;
    selectedProperty = null;
}

// === MYTHOS VS REALIT√ÑT ===
const mythAnswers = {
    '1': 'reality',
    '2': 'myth',
    '3': 'reality',
    '4': 'myth'
};

let answeredMyths = new Set();

function checkMyth(button, answer, mythNum) {
    if (answeredMyths.has(mythNum)) return;
    
    const card = button.closest('.myth-card');
    const buttons = card.querySelectorAll('.myth-btn');
    const explanation = document.getElementById('myth-explanation-' + mythNum);
    
    buttons.forEach(btn => btn.disabled = true);
    
    const correct = mythAnswers[mythNum] === answer;
    
    if (correct) {
        button.classList.add('correct');
        explanation.classList.add('correct');
    } else {
        button.classList.add('incorrect');
        const correctBtn = Array.from(buttons).find(btn => 
            btn.textContent.includes(mythAnswers[mythNum] === 'reality' ? 'Realit√§t' : 'Mythos')
        );
        if (correctBtn) correctBtn.classList.add('correct');
        explanation.classList.add('incorrect');
    }
    
    explanation.classList.add('show');
    answeredMyths.add(mythNum);
    saveProgress();
    
    if (answeredMyths.size === 4 && !completedActivities.myths) {
        setTimeout(() => {
            markActivityComplete('myths');
        }, 500);
    }
}

// === TIMELINE (AUTO-COMPLETE) ===
const timelineObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting && !completedActivities.timeline) {
            setTimeout(() => {
                markActivityComplete('timeline');
            }, 3000);
        }
    });
}, { threshold: 0.5 });

const timelineSection = document.querySelector('.timeline-visual');
if (timelineSection) {
    timelineObserver.observe(timelineSection);
}

// === QUIZ ===
let currentQuestion = 1;
let answeredQuestions = new Set();
let correctQuizAnswers = 0;
const totalQuestions = 6;

document.querySelectorAll('.option').forEach(option => {
    option.addEventListener('click', function() {
        const question = this.closest('.question');
        const questionNum = question.dataset.question;
        const options = question.querySelectorAll('.option');
        const feedback = question.querySelector('.feedback');
        const nextButton = question.querySelector('.next-button');
        
        if (answeredQuestions.has(questionNum)) return;
        
        options.forEach(opt => opt.classList.remove('selected'));
        this.classList.add('selected');
        
        const isCorrect = this.dataset.answer === 'correct';
        
        setTimeout(() => {
            if (isCorrect) {
                this.classList.add('correct');
                feedback.className = 'feedback correct show';
                feedback.textContent = '‚úì Richtig! ' + getCorrectFeedback(questionNum);
                correctQuizAnswers++;
            } else {
                this.classList.add('incorrect');
                options.forEach(opt => {
                    if (opt.dataset.answer === 'correct') {
                        opt.classList.add('correct');
                    }
                });
                feedback.className = 'feedback incorrect show';
                feedback.textContent = '‚úó Nicht ganz. ' + getCorrectFeedback(questionNum);
            }
            
            question.classList.add('answered');
            answeredQuestions.add(questionNum);
            nextButton.classList.add('show');
            updateProgress();
            saveProgress();
        }, 300);
    });
});

function showNextQuestion() {
    const currentQ = document.querySelector(`[data-question="${currentQuestion}"]`);
    currentQ.classList.remove('active');
    
    currentQuestion++;
    
    if (currentQuestion <= totalQuestions) {
        const nextQ = document.querySelector(`[data-question="${currentQuestion}"]`);
        nextQ.classList.add('active');
        saveProgress();
    } else {
        document.getElementById('completion-message').classList.add('show');
        trackQuizCompletion('artikel3', correctQuizAnswers, totalQuestions);
        markArticleComplete('artikel3');
        trackTimeSpent('artikel3');
        saveProgress();
    }
}

function updateProgress() {
    const progress = (answeredQuestions.size / totalQuestions) * 100;
    document.getElementById('progress-fill').style.width = progress + '%';
    document.getElementById('quiz-progress').textContent = `${answeredQuestions.size}/${totalQuestions}`;
}

function getCorrectFeedback(questionNum) {
    const feedbacks = {
        '1': '√ñsterreich 1759 (Siebenj√§hriger Krieg) und Grossbritannien 1796 (Krieg gegen Napoleon).',
        '2': 'Praktisch kein anderes Land hat beide Steuern gleichzeitig.',
        '3': 'Ausgerechnet Sozialdemokraten schafften sie ab, weil die Mittelklasse unfair belastet wurde.',
        '4': 'Ein drastischer R√ºckgang von historisch 40-80%!',
        '5': 'Die Kombination von extrem hohem Freibetrag und extrem hohem Steuersatz ist weltweit einzigartig.',
        '6': 'Die genannten Gr√ºnde sind: Friedenszeit, praktische Probleme, Kapitalmobilit√§t.'
    };
    return feedbacks[questionNum] || '';
}

// === BEIM LADEN ===
window.addEventListener('load', () => {
    trackPageVisit('artikel3');
    console.log('üìö Artikel 3 geladen');
    
    const hasProgress = loadProgress();
    if (hasProgress) {
        console.log('üîÑ Restoring previous progress...');
        restoreUIState();
    } else {
        console.log('üÜï Starting fresh');
    }
});

window.addEventListener('beforeunload', () => {
    trackTimeSpent('artikel3');
});

setInterval(() => {
    saveProgress();
}, 30000);
    </script>
</body>
</html>
